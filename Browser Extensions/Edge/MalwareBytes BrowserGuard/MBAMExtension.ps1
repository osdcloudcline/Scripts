$MBAMExtension = "MalwareBytes BrowserGuard Extension"

Write-Verbose "Installing $MBAMExtension..." -Verbose

$settings = 
[PSCustomObject]@{
    Path = "SOFTWARE\Policies\Microsoft\Edge\ExtensionInstallForceList"
    Value = "bojobppfploabceghnmlahpoonbcbacn" # Malwarebytes Anti-Malware
    Name = ++$count
}, | group Path

foreach($setting in $settings){
$registry = [Microsoft.Win32.Registry]::LocalMachine.OpenSubkey($setting.Name, $true)
if ($null -eq $registry){
$registry.SetValue($_.name, $_.value)
$registry = [Microsoft.Win32.Registry]::LocalMachine.CreateSubkey($setting.Name, $true)
}
$setting.Group | %{
    $registry.SetValue($_.name, $_.value)
}
$registry.Dispose()
}
